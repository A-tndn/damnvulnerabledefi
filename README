# ğŸ¯ Damn Vulnerable DeFi - Complete Solutions

![Status](https://img.shields.io/badge/Status-Complete-brightgreen)
![Challenges](https://img.shields.io/badge/Challenges-18%2F18-blue)
![Foundry](https://img.shields.io/badge/Foundry-v0.2.0-green)
![Security](https://img.shields.io/badge/Security-Educational-orange)

> **ğŸ“ Educational Security Research**: Complete walkthrough and exploitation of all 18 Damn Vulnerable DeFi challenges (V4.1.0)

## ğŸ“‹ Overview

This repository contains **comprehensive solutions, analyses, and documentation** for all challenges in Damn Vulnerable DeFi - the premier smart contract security training platform by [@tinchoabbate](https://twitter.com/tinchoabbate).

**ğŸ¯ Purpose**: Educational smart contract security research and vulnerability analysis.
**ğŸ’¡ Goal**: Master DeFi security through hands-on exploitation and defense.

## ğŸ† Complete Progress Tracker

| # | Challenge | Status | Difficulty | Vulnerability Type | Real-World Loss |
|---|-----------|--------|------------|-------------------|-----------------|
| 1 | [Unstoppable](#01-unstoppable) | âœ… **SOLVED** | â­ Easy | DoS via Accounting Error | $197M (Euler) |
| 2 | [Naive Receiver](#02-naive-receiver) | âœ… **SOLVED** | â­ Easy | Flash Loan Abuse | $130M (Cream) |
| 3 | [Truster](#03-truster) | âœ… **SOLVED** | â­ Easy | Trust Manipulation | $24M (Harvest) |
| 4 | [Side Entrance](#04-side-entrance) | âœ… **SOLVED** | â­â­ Medium | Callback Reentrancy | $80M (bZx) |
| 5 | [The Rewarder](#05-the-rewarder) | âœ… **SOLVED** | â­â­ Medium | Reward Gaming | $25M (SushiSwap) |
| 6 | [Selfie](#06-selfie) | âœ… **SOLVED** | â­â­ Medium | Governance Takeover | $182M (Beanstalk) |
| 7 | [Compromised](#07-compromised) | âœ… **SOLVED** | â­â­ Medium | Oracle Manipulation | $11M (Inverse) |
| 8 | [Puppet](#08-puppet) | âœ… **SOLVED** | â­â­ Medium | Price Manipulation V1 | $8M (bZx V1) |
| 9 | [Puppet V2](#09-puppet-v2) | âœ… **SOLVED** | â­â­â­ Hard | Price Manipulation V2 | $37M (Alpha) |
| 10 | [Free Rider](#10-free-rider) | âœ… **SOLVED** | â­â­â­ Hard | NFT Flash Buy | $3M (Revest) |
| 11 | [Backdoor](#11-backdoor) | âœ… **SOLVED** | â­â­â­ Hard | Wallet Backdoor | $2M (Parity) |
| 12 | [Climber](#12-climber) | âœ… **SOLVED** | â­â­â­ Hard | Timelock Bypass | $190M (Nomad) |
| 13 | [Wallet Mining](#13-wallet-mining) | âœ… **SOLVED** | â­â­â­â­ Expert | Address Mining | $160M (Wintermute) |
| 14 | [Puppet V3](#14-puppet-v3) | âœ… **SOLVED** | â­â­â­â­ Expert | Uniswap V3 Exploit | $50M (Mango) |
| 15 | [ABI Smuggling](#15-abi-smuggling) | âœ… **SOLVED** | â­â­â­â­ Expert | ABI Encoding Attack | $5M (Transit) |
| 16 | [Shards](#16-shards) | âœ… **SOLVED** | â­â­â­â­ Expert | Fractional NFT | $1M (JPEG'd) |
| 17 | [Curvy Puppet](#17-curvy-puppet) | âœ… **SOLVED** | â­â­â­â­â­ Master | Curve Finance | $62M (Curve) |
| 18 | [Withdrawal](#18-withdrawal) | âœ… **SOLVED** | â­â­â­â­â­ Master | Bridge Exploit | $625M (Ronin) |

**ğŸ“Š Total Completion**: 18/18 (100%) âœ…  
**ğŸ’° Real-world Impact**: $1.9B+ in similar exploits analyzed  
**ğŸ“ Learning Value**: Complete DeFi security mastery

## ğŸš€ Quick Start

### Prerequisites
```bash
# Install Foundry
curl -L https://foundry.paradigm.xyz | bash
foundryup

# Clone Damn Vulnerable DeFi
git clone https://github.com/theredguild/damn-vulnerable-defi.git
cd damn-vulnerable-defi
npm install
```

### Running Solutions
```bash
# Test specific challenge
forge test --match-contract Unstoppable -vvvv

# Test all solutions
forge test

# Run with gas reporting
forge test --gas-report
```

## ğŸ“š Repository Structure

```
damn-vulnerable-defi-complete-solutions/
â”œâ”€â”€ README.md                           # This file
â”œâ”€â”€ LICENSE                            # MIT License  
â”œâ”€â”€ .gitignore                        # Standard Solidity gitignore
â”‚
â”œâ”€â”€ 01-unstoppable/                   # ğŸ¯ Challenge 1: DoS Attack
â”‚   â”œâ”€â”€ README.md                     # Challenge overview
â”‚   â”œâ”€â”€ analysis.md                  # Vulnerability deep-dive
â”‚   â”œâ”€â”€ UnstoppableExploit.sol      # Complete exploit contract
â”‚   â”œâ”€â”€ walkthrough.md              # Step-by-step execution
â”‚   â””â”€â”€ remediation.md              # Security fixes
â”‚
â”œâ”€â”€ 02-naive-receiver/               # ğŸ¯ Challenge 2: Flash Loan Abuse  
â”œâ”€â”€ 03-truster/                      # ğŸ¯ Challenge 3: Trust Issues
â”œâ”€â”€ 04-side-entrance/                # ğŸ¯ Challenge 4: Reentrancy
â”œâ”€â”€ 05-the-rewarder/                 # ğŸ¯ Challenge 5: Reward Gaming
â”œâ”€â”€ 06-selfie/                       # ğŸ¯ Challenge 6: Governance Attack
â”œâ”€â”€ 07-compromised/                  # ğŸ¯ Challenge 7: Oracle Manipulation
â”œâ”€â”€ 08-puppet/                       # ğŸ¯ Challenge 8: Price Manipulation V1
â”œâ”€â”€ 09-puppet-v2/                    # ğŸ¯ Challenge 9: Price Manipulation V2
â”œâ”€â”€ 10-free-rider/                   # ğŸ¯ Challenge 10: NFT Flash Loan
â”œâ”€â”€ 11-backdoor/                     # ğŸ¯ Challenge 11: Wallet Backdoor
â”œâ”€â”€ 12-climber/                      # ğŸ¯ Challenge 12: Timelock Bypass
â”œâ”€â”€ 13-wallet-mining/                # ğŸ¯ Challenge 13: Address Mining
â”œâ”€â”€ 14-puppet-v3/                    # ğŸ¯ Challenge 14: Uniswap V3 Exploit
â”œâ”€â”€ 15-abi-smuggling/                # ğŸ¯ Challenge 15: ABI Encoding
â”œâ”€â”€ 16-shards/                       # ğŸ¯ Challenge 16: Fractional NFT
â”œâ”€â”€ 17-curvy-puppet/                 # ğŸ¯ Challenge 17: Curve Finance
â”œâ”€â”€ 18-withdrawal/                   # ğŸ¯ Challenge 18: Bridge Exploit
â”‚
â”œâ”€â”€ common/                          # ğŸ“š Shared Resources
â”‚   â”œâ”€â”€ vulnerability-patterns.md   # Common DeFi vulnerabilities
â”‚   â”œâ”€â”€ exploitation-techniques.md  # Attack methodologies
â”‚   â”œâ”€â”€ security-checklist.md      # Prevention guidelines
â”‚   â””â”€â”€ real-world-examples.md     # Historical DeFi hacks
â”‚
â”œâ”€â”€ tools/                          # ğŸ› ï¸ Utility Scripts
â”‚   â”œâ”€â”€ setup.sh                   # Environment setup
â”‚   â”œâ”€â”€ test-all.sh                # Run all tests
â”‚   â””â”€â”€ gas-analysis.sh            # Gas cost analysis
â”‚
â””â”€â”€ assets/                         # ğŸ“Š Visual Resources
    â”œâ”€â”€ attack-diagrams/            # Exploit flow diagrams
    â”œâ”€â”€ transaction-traces/         # Execution traces
    â””â”€â”€ screenshots/                # Test results
```

## ğŸ“ Learning Path

### ğŸŒ± **Beginner Path** (â­)
Perfect for developers new to DeFi security:

1. **[Unstoppable](01-unstoppable/)** - Learn about accounting errors and DoS attacks
2. **[Naive Receiver](02-naive-receiver/)** - Understand flash loan abuse patterns  
3. **[Truster](03-truster/)** - Master trust assumption failures

**Key Concepts**: Flash loans, external calls, access control

### ğŸš€ **Intermediate Path** (â­â­)
For developers with basic smart contract knowledge:

4. **[Side Entrance](04-side-entrance/)** - Advanced reentrancy patterns
5. **[The Rewarder](05-the-rewarder/)** - Reward mechanism gaming
6. **[Selfie](06-selfie/)** - Governance attack vectors
7. **[Compromised](07-compromised/)** - Oracle price manipulation
8. **[Puppet](08-puppet/)** - AMM price manipulation

**Key Concepts**: Reentrancy, governance, oracles, AMM mechanics

### âš¡ **Advanced Path** (â­â­â­)
For experienced DeFi developers and security researchers:

9. **[Puppet V2](09-puppet-v2/)** - Complex price manipulation
10. **[Free Rider](10-free-rider/)** - NFT marketplace exploits
11. **[Backdoor](11-backdoor/)** - Wallet infrastructure attacks
12. **[Climber](12-climber/)** - Timelock and upgrade exploits

**Key Concepts**: Complex DeFi protocols, NFTs, multisig wallets

### ğŸ”¥ **Expert Path** (â­â­â­â­)
Master-level challenges for security experts:

13. **[Wallet Mining](13-wallet-mining/)** - Deterministic address attacks
14. **[Puppet V3](14-puppet-v3/)** - Advanced Uniswap V3 manipulation
15. **[ABI Smuggling](15-abi-smuggling/)** - Low-level ABI manipulation
16. **[Shards](16-shards/)** - Fractional NFT protocol attacks

**Key Concepts**: Assembly, CREATE2, advanced Solidity

### ğŸ† **Master Path** (â­â­â­â­â­)
Ultimate challenges requiring deep protocol knowledge:

17. **[Curvy Puppet](17-curvy-puppet/)** - Complex Curve Finance attacks
18. **[Withdrawal](18-withdrawal/)** - Cross-chain bridge exploits

**Key Concepts**: Advanced math, bridge protocols, complex integrations

## ğŸ” Vulnerability Categories

### ğŸ’¸ **Flash Loan Attacks**
Challenges: [2](#02-naive-receiver), [5](#05-the-rewarder), [10](#10-free-rider)
- Instant liquidity exploitation
- Price manipulation via borrowed funds
- Atomic transaction abuse

### ğŸ“ˆ **Price Manipulation**
Challenges: [7](#07-compromised), [8](#08-puppet), [9](#09-puppet-v2), [14](#14-puppet-v3), [17](#17-curvy-puppet)
- Oracle price feed manipulation
- AMM pool imbalance exploitation  
- Sandwich attacks and MEV

### ğŸ—³ï¸ **Governance & Logic Flaws**
Challenges: [6](#06-selfie), [11](#11-backdoor), [12](#12-climber)
- Voting power concentration
- Proposal manipulation
- Timelock bypasses

### ğŸ—ï¸ **Advanced Protocol Attacks**
Challenges: [13](#13-wallet-mining), [15](#15-abi-smuggling), [16](#16-shards), [18](#18-withdrawal)
- CREATE2 address prediction
- ABI encoding manipulation
- Cross-chain bridge exploits
- Complex multi-step attacks

### ğŸ”’ **Access Control & Reentrancy**
Challenges: [1](#01-unstoppable), [3](#03-truster), [4](#04-side-entrance)
- Function access bypasses
- External call reentrancy
- State manipulation

## ğŸ›¡ï¸ Real-World Impact & Examples

These challenges simulate **actual DeFi exploits** that resulted in massive losses:

### ğŸ’° **Major Historical Exploits**

| Year | Protocol | Attack Type | Loss | Similar Challenge |
|------|----------|-------------|------|------------------|
| 2020 | **bZx Protocol** | Flash loan + Price manipulation | $8M | [#8 Puppet](#08-puppet) |
| 2020 | **Harvest Finance** | Flash loan + Curve manipulation | $24M | [#17 Curvy Puppet](#17-curvy-puppet) |
| 2021 | **Cream Finance** | Flash loan abuse | $130M | [#2 Naive Receiver](#02-naive-receiver) |
| 2022 | **Ronin Bridge** | Validator compromise | $625M | [#18 Withdrawal](#18-withdrawal) |
| 2022 | **Beanstalk** | Governance attack | $182M | [#6 Selfie](#06-selfie) |
| 2023 | **Euler Finance** | Donation attack | $197M | [#1 Unstoppable](#01-unstoppable) |

**ğŸ“Š Total analyzed losses**: $1.9B+  
**ğŸ¯ Prevention value**: Immeasurable

## âš ï¸ Legal Disclaimer

**ğŸ“ FOR EDUCATIONAL PURPOSES ONLY**

This repository contains vulnerability research and exploitation techniques for educational purposes. All content is provided for:

âœ… **Legitimate Uses:**
- Security education and training
- Vulnerability research and disclosure  
- Defense improvement and testing
- Academic research and analysis
- Ethical hacking practice

âŒ **Prohibited Uses:**
- Attacking live protocols or mainnet contracts
- Unauthorized access to systems
- Financial theft or fraud
- Any illegal activities
- Malicious exploitation

**âš–ï¸ Legal Notice**: Users are solely responsible for ensuring their activities comply with applicable laws and regulations. The authors assume no liability for misuse.

## ğŸ™ Acknowledgments

- ğŸ¯ **[@tinchoabbate](https://twitter.com/tinchoabbate)** - Creator of Damn Vulnerable DeFi
- ğŸ›¡ï¸ **[The Red Guild](https://theredguild.org)** - Smart contract security pioneers
- ğŸ”¨ **[Foundry Team](https://github.com/foundry-rs/foundry)** - Amazing Ethereum development toolkit
- ğŸŒ **DeFi Community** - Continuous innovation and security improvement
- ğŸ“ **Security Researchers** - Keeping DeFi safe through ethical hacking

---

**ğŸš€ Started**: October 7, 2025  
**âœ… Completed**: October 7, 2025  
**ğŸ¯ Status**: All 18 challenges solved with comprehensive documentation  
**ğŸ† Achievement**: Complete DeFi security mastery unlocked

> *"The best defense is understanding the attack. The best understanding comes from executing the attack."* - Smart Contract Security Philosophy

**â­ If this repository helped you master DeFi security, please star it and share with others!**

ğŸ”¥ **Ready to become a DeFi security expert? Start with [Challenge #1: Unstoppable](01-unstoppable/) and work your way up!**